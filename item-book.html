<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Item Book - Whipper Wiki</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
  <link rel="stylesheet" href="css/style.css">
  <style>
    .book-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .summary-card {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-md);
      padding: 1.5rem;
      text-align: center;
    }
    .summary-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent-gold);
    }
    .summary-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      margin-top: 0.25rem;
    }
    
    .tab-nav {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid var(--border-subtle);
      padding-bottom: 0.5rem;
    }
    .tab-btn {
      padding: 0.75rem 1.5rem;
      background: transparent;
      border: none;
      color: var(--text-secondary);
      cursor: pointer;
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
      transition: all 0.2s;
    }
    .tab-btn:hover {
      color: var(--text-primary);
      background: var(--bg-card);
    }
    .tab-btn.active {
      color: var(--accent-gold);
      background: var(--bg-card);
      border-bottom: 2px solid var(--accent-gold);
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    
    .item-book-table {
      width: 100%;
      border-collapse: collapse;
    }
    .item-book-table th {
      background: var(--accent-teal);
      color: var(--bg-dark);
      padding: 0.75rem;
      text-align: left;
      font-size: 0.75rem;
      text-transform: uppercase;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .item-book-table td {
      padding: 0.5rem 0.75rem;
      border-bottom: 1px solid var(--border-subtle);
    }
    .item-book-table tr:hover {
      background: rgba(245, 166, 35, 0.05);
    }
    .item-book-table tr.item-complete {
      background: rgba(0, 200, 150, 0.1);
    }
    
    .level-select {
      width: 80px;
      padding: 0.375rem;
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
    }
    .xp-input {
      width: 60px;
      padding: 0.375rem;
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      text-align: right;
    }
    .xp-max {
      color: var(--text-secondary);
      font-size: 0.85rem;
    }
    .bp-value {
      font-weight: 600;
      color: var(--text-secondary);
    }
    .bp-value.has-bp {
      color: var(--accent-gold);
    }
    
    .book-actions {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .book-actions .btn {
      padding: 0.5rem 1rem;
    }
    
    .dungeon-row {
      display: grid;
      grid-template-columns: 1fr 100px 100px 80px;
      gap: 0.5rem;
      align-items: center;
      padding: 0.5rem;
      border-bottom: 1px solid var(--border-subtle);
    }
    .dungeon-row:hover {
      background: rgba(245, 166, 35, 0.05);
    }
    .dungeon-name {
      font-weight: 500;
    }
    .dungeon-xp {
      width: 80px;
      padding: 0.375rem;
      background: var(--bg-input);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      text-align: right;
    }
    .dungeon-total {
      color: var(--text-secondary);
      font-size: 0.85rem;
    }
    .dungeon-percent {
      color: var(--accent-teal);
      font-weight: 600;
    }
    
    .table-scroll {
      max-height: 60vh;
      overflow-y: auto;
    }
    
    #import-file {
      display: none;
    }
  </style>
</head>
<body>
  <div id="wiki-header"></div>

  <main class="main">
    <div class="container">
      <header class="page-header">
        <h1>Item Book</h1>
        <p>Track your item analysis progress. Earn 1 BP for every 5 analysis levels. Data saves to your browser.</p>
      </header>

      <div class="book-summary">
        <div class="summary-card">
          <div class="summary-value"><span id="total-bp">0</span> / <span id="max-bp">664</span></div>
          <div class="summary-label">Total BP</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="completion-percent">0.00%</div>
          <div class="summary-label">Book Completion</div>
        </div>
        <div class="summary-card">
          <div class="summary-value"><span id="items-completed">0</span> / <span id="total-items">166</span></div>
          <div class="summary-label">Items Maxed</div>
        </div>
        <div class="summary-card">
          <div class="summary-value" id="xp-progress">0 / 0</div>
          <div class="summary-label">Total XP</div>
        </div>
      </div>

      <div class="book-actions">
        <button id="export-btn" class="btn btn-secondary">Export Data</button>
        <button id="import-btn" class="btn btn-secondary">Import Data</button>
        <input type="file" id="import-file" accept=".json">
        <button id="reset-btn" class="btn btn-danger">Reset All</button>
      </div>

      <div class="tab-nav">
        <button class="tab-btn active" data-tab="weapons-tab">Weapons</button>
        <button class="tab-btn" data-tab="armor-tab">Armor</button>
        <button class="tab-btn" data-tab="rings-tab">Rings</button>
        <button class="tab-btn" data-tab="dungeons-tab">Dungeons</button>
      </div>

      <div id="weapons-tab" class="tab-content active">
        <div class="table-scroll">
          <table class="item-book-table" id="weapons-table">
            <thead>
              <tr>
                <th>Weapon</th>
                <th>Level</th>
                <th>XP to Next</th>
                <th>BP</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="4" class="loading">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="armor-tab" class="tab-content">
        <div class="table-scroll">
          <table class="item-book-table" id="armor-table">
            <thead>
              <tr>
                <th>Armor</th>
                <th>Level</th>
                <th>XP to Next</th>
                <th>BP</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="4" class="loading">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="rings-tab" class="tab-content">
        <div class="table-scroll">
          <table class="item-book-table" id="rings-table">
            <thead>
              <tr>
                <th>Ring</th>
                <th>Level</th>
                <th>XP to Next</th>
                <th>BP</th>
              </tr>
            </thead>
            <tbody>
              <tr><td colspan="4" class="loading">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="dungeons-tab" class="tab-content">
        <div class="card">
          <h3>Dungeon XP Progress</h3>
          <p class="text-muted mb-2">Track your exploration progress per dungeon.</p>
          <div id="dungeon-progress">
            <div class="loading">Loading...</div>
          </div>
        </div>
      </div>

      <div class="card mt-3">
        <h3>XP Chart</h3>
        <p class="text-muted mb-1">XP required to reach each analysis level:</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 0.5rem; font-size: 0.85rem;">
          <div>Lv 1: 1</div><div>Lv 2: 3</div><div>Lv 3: 7</div><div>Lv 4: 15</div><div>Lv 5: 31 (+1 BP)</div>
          <div>Lv 6: 63</div><div>Lv 7: 103</div><div>Lv 8: 151</div><div>Lv 9: 207</div><div>Lv 10: 271 (+1 BP)</div>
          <div>Lv 11: 335</div><div>Lv 12: 399</div><div>Lv 13: 463</div><div>Lv 14: 527</div><div>Lv 15: 591 (+1 BP)</div>
          <div>Lv 16: 719</div><div>Lv 17: 847</div><div>Lv 18: 975</div><div>Lv 19: 1103</div><div>Lv 20: 1231 (+1 BP)</div>
        </div>
      </div>
    </div>
  </main>

  <div id="wiki-footer"></div>
  <script src="js/helpers.js"></script>
  <script src="js/pages/item-book.js"></script>
</body>
</html>
